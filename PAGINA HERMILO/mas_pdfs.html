<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi sitio web - Más PDF's</title>
    <link rel="stylesheet" type="text/css" href="css/mas_pdfs.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    
</head>
<body>

    <!-- PARTE SUPERIOR DONDE IRAN LOGOS -->
    <div class="top-nav">
        <div class="logos">
            <a href="https://www.gob.mx/" target="_blank">
                <img src="https://i.pinimg.com/736x/c5/67/dc/c567dc50db12bb844d71f8f611583611.jpg" alt="Gobierno de México">
            </a>
            <a href="https://www.gob.mx/sep" target="_blank">
                <img src="https://i.pinimg.com/736x/a0/42/ba/a042ba51232d2114a4d19adc0d77cf6b.jpg" alt="SEP">
            </a>
            <a href="https://tapachula.tecnm.mx" target="_blank">
                <img src="images/Tecnologico_Nacional_de_Mexico.svg" alt="TECNM">
            </a>
            <a href="https://tapachula.tecnm.mx/" target="_blank">
                <img src="https://i.pinimg.com/474x/e3/d3/d8/e3d3d8e6fe10654379ec08be05ed598e.jpg" alt="TecNM Tapachula">
            </a>
        </div>
        <div class="icons">
            <a href="#" target="_blank">
                <img src="path/to/buscar-icon.png" alt="Buscador">
            </a>
        </div>
    </div>

    <header class="header">
        <div class="menu container">
            <a href="index.html" class="logo">TecNM</a>
            <input type="checkbox" id="menu"/>
            <label for="menu">
                <img src="https://i.pinimg.com/474x/98/43/ee/9843eeb5cc80af7ff3eea8adc04a3265.jpg" class="menu-icono" alt="">
            </label>

            <nav class="navbar">
                <ul>
                    <li><a href="index.html">Inicio</a></li>
                    <li><a href="mas_pdfs.html">Mas Pdf's</a></li>
                    <li><a href="quienes_somos.html">Quienes Somos</a></li>
                    <li><a href="contacto.html">Contacto</a></li>
                </ul>
            </nav>
        </div>

        <div class="header-content container">
            <h1>Más pdf´s</h1>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. 
                Iusto recusandae quaerat libero vitae dolores, doloremque at impedit nesciunt sit distinctio accusamus dolorem, 
                unde placeat aperiam dolor numquam tempore aliquam architecto?
            </p>
        </div>
    </header>

    <!-- SECCIÓN PARA MOSTRAR LOS PDFS -->
    <div class="pdf-section">
        <h2>PDF Articles</h2>
        <div class="filter">
            <label for="categoryFilter">Filtrar por categoría:</label>
            <select id="categoryFilter" onchange="filterPDFs()">
                <option value="all">Todas</option>
                <!-- Las opciones se agregarán dinámicamente -->
            </select>
        </div>
        <div class="pdf-container" id="pdfContainer"></div>

        <div class="modal" id="pdfModal">
            <h2 id="pdfName"></h2>
            <button id="viewBtn">View PDF</button>
            <button id="downloadBtn">Download PDF</button>
            <button onclick="closeModal()">Close</button>
        </div>
    </div>

    <!--FOOTER DE PRUEBA 1-->
    <footer class="footer">
        <div class="footer-content container">
            <div class="link">
                <h3>lorem</h3>
                <ul>
                    <li><a href="#">lorem1</a></li>
                    <li><a href="#">lorem2</a></li>
                    <li><a href="#">lorem3</a></li>
                    <li><a href="#">lorem4</a></li>
                </ul>
            </div>
            <div class="link">
                <h3>lorem</h3>
                <ul>
                    <li><a href="#">lorem1</a></li>
                    <li><a href="#">lorem2</a></li>
                    <li><a href="#">lorem3</a></li>
                    <li><a href="#">lorem4</a></li>
                </ul>
            </div>
            <div class="link">
                <h3>lorem</h3>
                <ul>
                    <li><a href="#">lorem1</a></li>
                    <li><a href="#">lorem2</a></li>
                    <li><a href="#">lorem3</a></li>
                    <li><a href="#">lorem4</a></li>
                </ul>
            </div>
            <div class="link">
                <h3>lorem</h3>
                <ul>
                    <li><a href="#">lorem1</a></li>
                    <li><a href="#">lorem2</a></li>
                    <li><a href="#">lorem3</a></li>
                    <li><a href="#">lorem4</a></li>
                </ul>
            </div>
        </div>
    </footer>

    <!--FOOTER DE PRUEBA 2-->
    <footer class="footer2">
        <div class="social-icons">
            <a href="#"><ion-icon name="logo-facebook"></ion-icon></a>
            <a href="#"><ion-icon name="logo-whatsapp"></ion-icon></a>
            <a href="#"><ion-icon name="logo-youtube"></ion-icon></a>
            <a href="#"><ion-icon name="logo-instagram"></ion-icon></a>
        </div>
        <p>Copyright © <script>document.write(new Date().getFullYear())</script> | TecNM Campus Tapachula.</p>
            <p>All rights reserved</p>
    </footer>
    
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

    <script>
        let currentPDFs = []; // Lista de PDFs actuales
        let allPDFs = []; // Lista de todos los PDFs
        let categories = []; // Lista de categorías

        // Función para obtener los PDFs desde la API
        async function fetchPDFs() {
            const response = await fetch('https://script.google.com/macros/s/AKfycbwwFhrP3DI4EOelGrUmPFDLsUl5o-l-r_Kq4o9waAW7RB-cOxyPhrdnajfbykQ6giIB/exec'); // Reemplazar con la URL de la API
            const data = await response.json();
            return data;
        }

        // Función para actualizar la lista de PDFs en el contenedor
        function updatePDFs(pdfs) {
            const container = document.getElementById('pdfContainer');
            container.innerHTML = ''; // Limpiar el contenedor

            pdfs.forEach(pdf => {
                const item = document.createElement('div');
                item.classList.add('pdf-item');
                item.dataset.categoria = pdf.categoria;

                const img = document.createElement('img');
                img.src = 'https://i.pinimg.com/474x/af/17/8b/af178b579990dc286c2ba73d5c162aec.jpg'; // Usa la imagen del PDF o una imagen por defecto
                img.alt = pdf.nombre;

                const name = document.createElement('p');
                name.textContent = pdf.nombre;

                item.appendChild(img);
                item.appendChild(name);
                item.onclick = () => openModal(pdf);

                container.appendChild(item);
            });
        }

        // Función para actualizar el filtro de categorías
        function updateCategoryFilter() {
            const filter = document.getElementById('categoryFilter');
            const currentCategory = filter.value; // Guardar la categoría seleccionada actualmente
            filter.innerHTML = '<option value="all">Todas</option>';
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                filter.appendChild(option);
            });
            filter.value = currentCategory; // Restaurar la categoría seleccionada actualmente
        }

        // Función para filtrar los PDFs según la categoría seleccionada
        function filterPDFs(selectedCategory = null) {
            const category = selectedCategory || document.getElementById('categoryFilter').value;
            const filteredPDFs = category === 'all' ? allPDFs : allPDFs.filter(pdf => pdf.categoria === category);
            updatePDFs(filteredPDFs);
        }

        // Función para abrir el modal con los detalles del PDF
        function openModal(pdf) {
            const modal = document.getElementById('pdfModal');
            const name = document.getElementById('pdfName');
            const viewBtn = document.getElementById('viewBtn');
            const downloadBtn = document.getElementById('downloadBtn');

            name.textContent = pdf.nombre;
            viewBtn.onclick = () => window.open(pdf.url, '_blank');
            downloadBtn.onclick = () => window.open(pdf.downloadUrl, '_blank');

            modal.classList.add('active');
        }

        // Función para cerrar el modal
        function closeModal() {
            const modal = document.getElementById('pdfModal');
            modal.classList.remove('active');
        }

        // Función para verificar si hay nuevos PDFs cada 30 segundos
        async function checkForNewPDFs() {
            const data = await fetchPDFs();
            // Comparar el nuevo listado con el actual
            if (JSON.stringify(data.pdfs) !== JSON.stringify(allPDFs) || JSON.stringify(data.categories) !== JSON.stringify(categories)) {
                allPDFs = data.pdfs;
                categories = data.categories;
                const selectedCategory = document.getElementById('categoryFilter').value;
                filterPDFs(selectedCategory); // Filtrar por la categoría seleccionada actualmente
                updateCategoryFilter(); // Actualizar el filtro de categorías
            }
        }

        // Inicializar los datos al cargar la página
        (async function initialize() {
            const data = await fetchPDFs();
            allPDFs = data.pdfs;
            categories = data.categories;
            updateCategoryFilter();
            filterPDFs();
        })();

        // Llamar a la función checkForNewPDFs cada 30 segundos sin reiniciar el filtro
        setInterval(checkForNewPDFs, 5000);

    </script>
</body>
</html>
